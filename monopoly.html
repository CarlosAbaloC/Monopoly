<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Tablero Monopoly</title>
    <script src="Script.js"></script>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            height: 100%;
            background-color: #0077b6;
            /* display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;  */

        }

        .container {
            height: 100%;
        }

        .ui {
            height: 100%;
            display: grid;
            grid-template-columns: 1fr 3fr 1fr;
            grid-template-rows: 1fr 5fr;

        }



        .propiedades {
            background-color: cyan;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: repeat(5, 1fr);
        }

        .tablero {
            display: grid;
            grid-template-columns: 2fr repeat(6, 2fr) 2fr;
            grid-template-rows: 2fr repeat(6, 2fr) 2fr;

            border: 5px solid #000;
            background-color: #f5d76e;
            padding: 10px;
        }

        .casilla {
            height: 95%;
            background-color: white;
            border: 3px solid black;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0px;
        }

        /* img:active {
            width: 100px;
            height: 100px;
            position: relative;
            
            z-index: 3;
        } */

        .centro {
            background-color: beige;
            grid-area: 2 / 2 / 8 / 8;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 50;
        }

        .ficha {
            width: 25%;
            height: 80%;
            text-align: center;

            display: flex;
            justify-content: center;
            align-items: center;

            left: 0px;
            bottom: 0px;

            border: 3px;
            border-style: solid;
            border-color: black;
            border-radius: 50% 50%;

        }

        #ficha1 {
            background-color: blue;
            /* left: 60px;
            bottom: 35px; */
        }

        #ficha2 {
            background-color: green;
            /* left:0px;
            bottom: 35px; */
        }

        .info {
            text-align: center;
            background-color: lightcoral;
            display: flex;
            flex-direction: column-reverse;
            justify-content: center;
        }

        .turno {
            background-color: bisque;
        }

        .cronoGeneral {
            background-color: #f5d76e;
        }

        .dado {
            z-index: 2;
            background-color: darkblue;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin: 0% 40%;

        }

        img {
            width: 100%;
            height: 100%;

        }


        /* #jugador1 img, #jugador2 img {
            padding: 4px;
            height: 120px;
            width: 80px;

        } */
        .carta {
            z-index: 0;
        }


        .dado img {

            width: 100%;
            height: 100%;
        }

        .cartadiv {
            height: 100%;
            border: 1px solid black;
            display: grid;
            /* grid-template-columns: repeat(5, 1fr); */
            grid-template-rows: 1fr 2fr 1fr;
            /* box-sizing: border-box; */
        }

        .casas {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: 1fr;
        }

        .cartadiv .fila2 {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .cartadiv .fila3 {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .cartadiv p {
            /* box-sizing: border-box; */
            /* padding: 10px; */
            border: 1px solid #ddd;
            text-align: center;
            /* font-size: 16px; */
            /* Ajusta el tamaño de la fuente según tus preferencias */
            margin: 0;
            /* Asegura que no haya márgenes predeterminados */
        }

        .color-rojo {
            background-color: red;
        }

        .calle {
            position: relative;
            z-index: 0;
            width: 100%;
        }

        .color-amarillo {
            background-color: yellow;
        }

        .color-verde {
            background-color: green;
        }

        .color-naranja {
            background-color: orange;
        }

        .color-rosa {
            background-color: pink;
        }

        .color-marron {
            background-color: brown;
        }

        .color-celeste {
            background-color: lightblue;
        }

        .color-azul {
            background-color: blue;
        }
    </style>
    <script>
        
    </script>
</head>

<body>
    <div class="container">
        <div class="ui">

            <div class="nomJug" id="jug1">
                <!-- <p style="text-align: center;">JUGADOR 1</p> -->
            </div>

            <div class="info">
                <div class="turno">
                    <p>Turno del jugador 1</p>
                </div>
                <div class="cronoGeneral">
                    <span id="minutos">01</span>:<span id="segundos">00</span>
                </div>
            </div>

            <div class="nomJug" id="jug2">
                <!-- <p style="text-align: center;">JUGADOR 2</p> -->
            </div>

            <div class="propiedades" id="jugador1" ondrop="drop(event)" ondragover="allowDrop(event)">
            </div>

            <div class="tablero">
                <!-- Casillas de juego -->

                <!-- Primera fila -->
                <div id="1" class="casilla parking">

                    <div class="cartadiv" id="carta1">
                        <div></div>
                        <div class="fila2">
                            <img src="Calle.png" class="calle" id="carta111" alt="" draggable="false"
                                ondragstart="drag(event)">
                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>

                <div id="2" class="casilla color-rojo">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;1</p>
                            <p>&nbsp;1</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar" onclick="arrayCartas('2')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f2">
                            <img src="2.png" class="calle" id="carta111" alt="" draggable="false"
                                ondragstart="drag(event , this.parentElement.id)">
                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="3" class="casilla suerte">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;1</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar" onclick="arraySuerte('ficha2, fila2')">&#128269;</button>
                        </div>

                        <div class="fila2">
                            <img src="Suerte.png" class="calle" id="carta2" alt="" draggable="false"
                                ondragstart="drag(event)">
                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="4" class="casilla color-rojo">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('4')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f4">
                            <img src="4.png" class="calle" id="carta3" alt="" draggable="true"
                                ondragstart="drag(event, this.parentElement.id)">
                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="5" class="casilla color-amarillo">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('5')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f5">
                            <img src="5.png" class="calle" id="carta4" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.classList)">
                        </div>
                        <div class="fila3"></div>
                    </div>

                </div>
                <div id="6" class="casilla agua">

                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;1</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar">&#128269;</button>
                        </div>

                        <div class="fila2" id="f6">
                            <img src="Agua.png" class="calle" id="carta5" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">
                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="7" class="casilla color-amarillo">

                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;1</p>
                            <p>&nbsp;1</p>
                            <p>&nbsp;1</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('7')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f7">
                            <img src="7.png" class="calle" id="carta6" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="8" class="casilla policia">
                    <div class="cartadiv" id="carta1">
                        <div></div>
                        <div class="fila2">
                            <img src="Calle.png" class="calle" id="carta111" alt="" draggable="false"
                                ondragstart="drag(event)">
                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>

                <div class="centro">
                    MONOPOLY
                    <div class="dado">

                        <img src="dado.jpg" alt="">
                    </div>
                </div>

                <!-- Laterales -->
                <div id="28" class="casilla color-naranja">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('28')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f28">
                            <img src="28.png" class="calle" id="carta7" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>

                <div id="9" class="casilla color-verde">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('9')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f9">
                            <img src="9.png" class="calle" id="carta8" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="27" class="casilla comunidad">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar" onclick="arrayComunidad('ficha2')">&#128269;</button>
                        </div>

                        <div class="fila2">
                            <img src="Comunidad.png" class="calle" id="carta9" alt="" draggable="false"
                                ondragstart="drag(event)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="10" class="casilla comunidad">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar" onclick="arrayComunidad('ficha2')">&#128269;</button>
                        </div>

                        <div class="fila2">
                            <img src="Comunidad.png" class="calle" id="carta10" alt="" draggable="false"
                                ondragstart="drag(event)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="26" class="casilla color-naranja">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('26')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f26">
                            <img src="26.png" class="calle" id="carta11" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="11" class="casilla color-verde">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('11')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f11">
                            <img src="11.png" class="calle" id="carta12" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="25" class="casilla color-rosa">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('25')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f25">
                            <img src="25.png" class="calle" id="carta13" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="12" class="casilla color-azul">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar" onclick="arraySuerte('ficha2, fila2')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f12">
                            <img src="Suerte.png" class="calle" id="carta14" alt="" draggable="false"
                                ondragstart="drag(event)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="24" class="casilla luz">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar">&#128269;</button>
                        </div>

                        <div class="fila2" id="f24">
                            <img src="Luz.png" class="calle" id="carta23" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="13" class="casilla lujo">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar">&#128269;</button>
                        </div>

                        <div class="fila2">
                            <img src="lujo.png" class="calle" id="carta15" alt="" draggable="false"
                                ondragstart="drag(event)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="23" class="casilla color-rosa">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('23')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f23">
                            <img src="23.png" class="calle" id="carta16" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="14" class="casilla color-azul">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('14')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f14">
                            <img src="14.png" class="calle" id="carta17" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>

                <!-- Ultima fila -->
                <div id="22" class="casilla carcel">
                    <div class="cartadiv" id="carta1">
                        <div></div>
                        <div class="fila2">
                            <img src="Calle.png" class="calle" id="carta111" alt="" draggable="false"
                                ondragstart="drag(event)">
                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="21" class="casilla color-celeste">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('21')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f21">
                            <img src="21.png" class="calle" id="carta18" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="20" class="casilla suerte">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar" onclick="arraySuerte('ficha2, fila2')">&#128269;</button>
                        </div>

                        <div class="fila2">
                            <img src="Suerte.png" class="calle" id="carta19" alt="" draggable="false"
                                ondragstart="drag(event)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="19" class="casilla color-celeste">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('19')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f19">
                            <img src="19.png" class="calle" id="carta20" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="18" class="casilla color-marron">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('18')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f18">
                            <img src="18.png" class="calle" id="carta21" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="17" class="casilla comunidad">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar" onclick="arrayComunidad('ficha2')">&#128269;</button>
                        </div>

                        <div class="fila2">
                            <img src="Comunidad.png" class="calle" id="carta22" alt="" draggable="false"
                                ondragstart="drag(event)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="16" class="casilla color-marron">
                    <div class="cartadiv" id="carta1">
                        <div class="casas">
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <p>&nbsp;&nbsp;</p>
                            <button id="mostrar"  onclick="arrayCartas('16')">&#128269;</button>
                        </div>

                        <div class="fila2" id="f16">
                            <img src="16.png" class="calle" id="carta23" alt="" draggable="false"
                                ondragstart="drag(event, this.parentElement.id)">

                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>
                <div id="15" class="casilla salida">
                    <div class="cartadiv" id="carta1">
                        <div></div>
                        <div class="fila2">
                            <img src="Calle.png" class="calle" id="carta111" alt="" draggable="false"
                                ondragstart="drag(event)">
                        </div>
                        <div class="fila3"></div>
                    </div>
                </div>

            </div>

            <div class="propiedades" id="jugador2" ondrop="drop(event)" ondragover="allowDrop(event)">
            </div>

            <!-- <div class="cronoJ1">
            <p style="text-align: center;">CRONOMETRO</p>
        </div>
        

        <div class="cronoJ1">
            <p style="text-align: center;">CRONOMETRO</p>
        </div> -->


        </div>
    </div>

    <script>
        const NUM_JUGADORES = 2;
        var dineroJ1 = 30000;
        var dineroJ2 = 30000;

        for (i = 0; i < NUM_JUGADORES; i++) {
            ficha = document.createElement('div');
            ficha.classList.add('ficha')
            ficha.id = "ficha" + (i + 1);

            casillaInicio = document.getElementById("2");
            espFichas = casillaInicio.getElementsByClassName('fila3')[0]
            espFichas.appendChild(ficha);
        }

        console.log("Nombre1: "+localStorage.getItem("jug1"))

        //ASIGNAR NOMBRE
        divNombre1 = document.createElement("p")
        divNombre1.textContent = localStorage.getItem("jug1");
        document.getElementById("jug1").appendChild(divNombre1);

        divNombre2 = document.createElement("p")
        divNombre2.textContent = localStorage.getItem("jug2");
        document.getElementById("jug2").appendChild(divNombre2);


        

        //ASIGNAR DINERO
        divDinero1 = document.createElement("p");
        divDinero1.textContent = dineroJ1 + "";
        div1 = document.getElementById("jug1")
        div1.appendChild(divDinero1);

        divDinero2 = document.createElement("p");
        divDinero2.textContent = dineroJ2 + "";
        div2 = document.getElementById("jug2")
        div2.appendChild(divDinero2);

        listaCasillas1 = [];
        listaCasillas2 = [];

        //CRONO GENERAL
        document.addEventListener("DOMContentLoaded", function () {
            var minutos = 1;
            var segundos = 0;

            var minutosDisplay = document.getElementById("minutos");
            var segundosDisplay = document.getElementById("segundos");

            function actualizarCronometro() {
                segundos--;
                if (segundos < 0) {
                    segundos = 559;
                    minutos--;
                }

                if (minutos < 0) {
                    // Aquí puedes añadir acciones una vez que la cuenta regresiva llegue a cero
                    alert("¡Tiempo terminado!");
                    clearInterval(intervalo);
                    sonidoFinal();
                    minutos = 0;
                    segundos = 0;
                }

                minutosDisplay.textContent = minutos.toString().padStart(2, "0");
                segundosDisplay.textContent = segundos.toString().padStart(2, "0");
            }

            var intervalo = setInterval(actualizarCronometro, 1000);
        });


        //MOVIMIENTO DE FICHAS CON DADO
        victoria = false;
        turno = 0;
        let numero_casillas = document.getElementsByClassName("casilla").length;
        casillas = document.getElementsByClassName("casilla")

        tablero = document.getElementsByClassName("tablero")[0];

        f1 = document.getElementById("ficha1");
        f2 = document.getElementById("ficha2");

        dado = document.getElementsByClassName("dado")[0].getElementsByTagName("img")[0];
        dado.addEventListener("click", girarDado);

        function moverNCasillas(ficha, despl) {
            console.log("Ficha: " + ficha)
            estilos = getComputedStyle(ficha);

            if (victoria === false) {
                ficha.style.zIndex = 1;

                ficha_left = estilos.getPropertyValue("left");; console.log("left: " + ficha_left)
                ficha_bottom = estilos.getPropertyValue("bottom"); console.log("bottom: " + ficha_bottom)

                posActual = numCasillaFicha(ficha);
                console.log("Posicion actual ficha " + ficha.id + ": " + posActual);
                nodragable(posActual);
                

                posFinal = posActual + despl;
                console.log("Posicion final ficha " + ficha.id + ": " + posFinal);



                if (posFinal > numero_casillas) {
                    posFinal -= numero_casillas;
                }
                dragable(posFinal);
                listaFunciones(posFinal, ficha.id);
                // if(posFinal >= numero_casillas-1){
                //     posFinal = numero_casillas -1
                //     victoria = true;
                // }

                const rectIni = getCasillaEnPos(posActual).getBoundingClientRect();
                const coordenadaXIni = rectIni.left + window.scrollX;
                const coordenadaYIni = rectIni.top + window.scrollY;
                console.log("coordenadaXInicio: " + coordenadaXIni + ", coordenadaYInicio: " + coordenadaYIni)

                const rectFinal = getCasillaEnPos(posFinal).getBoundingClientRect();
                const coordenadaXFin = rectFinal.left + window.scrollX;
                const coordenadaYFin = rectFinal.top + window.scrollY;
                console.log("coordenadaXFinal: " + coordenadaXFin + ", coordenadaYFinal: " + coordenadaYFin)

                // Crea una nueva animación solo para la ficha
                const animation = ficha.animate(
                    [
                        { transform: 'translate(0, 0) rotate(0deg)' }, // Estado inicial: sin traslación y rotación
                        { transform: `translate(${coordenadaXFin - coordenadaXIni}px, ${coordenadaYFin - coordenadaYIni}px) rotate(720deg)` } // Estado final: traslación y rotación
                    ],
                    {
                        duration: 2000,
                        easing: "ease"
                    }
                );


                animation.onfinish = () => {
                    //ficha.style.left = ficha_left+ "px";
                    //ficha.style.bottom = ficha_bottom+"px"
                    // tablero.children[posActual].removeChild(ficha);
                    // tablero.children[posFinal].appendChild(ficha);
                    casillaIni = document.getElementById(posActual + "")
                    casillaFin = document.getElementById(posFinal + "")

                    casillaIni.getElementsByClassName("fila3")[0].removeChild(ficha)
                    casillaFin.getElementsByClassName("fila3")[0].appendChild(ficha)

                    if (victoria === true) {
                        alert("VICTORIA")
                    } else {
                        analizarCasilla(ficha, casillaFin)
                    }
                };
            }

        }

        function analizarCasilla(ficha, casilla) {
            if ((listaCasillas1.includes(casilla) && ficha === f1) || (listaCasillas2.includes(casilla) && ficha === f2)) {
                console.log("F1 cae en casilla de f1")

                //sacar color de casilla
                let color = casilla.classList[1];
                console.log(color);

                //comprobar si se tienen las 2 casillas de ese color
                let numeroCasillasColor = numCasillasColor(ficha, color);

                if (numeroCasillasColor == 2) {
                    if (confirm("¿Quieres comprar una casa?") == true) {

                        //comprobar numero de casas
                        let c = numCasasCasilla(casilla);

                        if (c <= 4) {
                            casilla.getElementsByClassName("casas")[0].children[c].innerHTML = "&nbsp;1";

                            if (ficha === f1) {
                                if (Number(divDinero1.textContent) >= 300) {
                                    divDinero1.textContent = (Number(divDinero1.textContent) - 300) + "";
                                } else {
                                    alert("No tienes dinero suficiente")
                                }

                            } else if (ficha === f2) {
                                if (Number(divDinero2.textContent) >= 300) {
                                    divDinero2.textContent = (Number(divDinero2.textContent) - 300) + "";
                                } else {
                                    alert("No tienes dinero suficiente")
                                }
                            }
                        }else{ //HOTELES
                            alert("No puedes comprar más casas");
                        }
                    }
                }


            } else if (listaCasillas1.includes(casilla) && ficha === f2) {
                console.log("F2 cae en casilla de f1")

                let c = numCasasCasilla(casilla);
                valor = 500 + c * 300;

                if (Number(divDinero2.textContent) >= valor) {
                    divDinero2.textContent = (Number(divDinero2.textContent) - valor) + "";
                    divDinero1.textContent = (Number(divDinero1.textContent) + valor) + "";
                    alert("Le has pagado " + valor + " € a J1")
                } else {
                    victoria = true;
                    alert("No tienes dinero suficiente. Has perdido")
                }


            } else if (listaCasillas2.includes(casilla) && ficha === f1) {
                console.log("F1 cae en casilla de f2")
                let c = numCasasCasilla(casilla);
                valor = 500 + c * 300;

                if (Number(divDinero1.textContent) >= valor) {
                    divDinero1.textContent = (Number(divDinero1.textContent) - valor) + "";
                    divDinero2.textContent = (Number(divDinero2.textContent) + valor) + "";
                    alert("Le has pagado " + valor + " € a J2")

                } else {
                    victoria = true;
                    alert("No tienes dinero suficiente. Has perdido")
                }


            } else {
                console.log("casilla no es de nadie");
                console.log("color: " + casilla.classList[1]);
                console.log("Numero de casas: " + numCasasCasilla(casilla));
                if (confirm("¿Quieres comprar la calle?") == true) {
                    if (ficha === f1) {
                        if (Number(divDinero1.textContent) >= 800) {
                            listaCasillas1.push(casilla);
                            divDinero1.textContent = (Number(divDinero1.textContent) - 800) + "";
                        } else {
                            alert("No tienes dinero suficiente")
                        }

                    } else if (ficha === f2) {
                        if (Number(divDinero1.textContent) >= 800) {
                            listaCasillas2.push(casilla);
                            divDinero2.textContent = (Number(divDinero2.textContent) - 800) + "";
                        } else {
                            alert("No tienes dinero suficiente")
                        }
                    }
                }
            }

            console.log("casillas 1: " + listaCasillas1);
            console.log("casillas 2: " + listaCasillas2);
        }

        function numCasillasColor(ficha, color) {
            let num = 0;
            if (ficha == f1) {
                listaCasillas1
                for (i = 0; i < listaCasillas1.length; i++) {
                    if (listaCasillas1[i].classList[1] == color) {
                        num++;
                    }
                }
            } else {
                listaCasillas2
                for (i = 0; i < listaCasillas2.length; i++) {
                    if (listaCasillas2[i].classList[1] == color) {
                        num++;
                    }
                }
            }
            return num;
        }

        function numCasasCasilla(casilla) {
            let total = 0;

            casas = casilla.getElementsByClassName("casas")[0];
            console.log(casas.children)
            for (let i = 0; i < casas.children.length - 1; i++) {
                console.log(casas.children[i].innerText)
                if (casas.children[i].innerHTML != "&nbsp;&nbsp;") {
                    total++;
                }
            }
            //console.log(total)
            return total;
        }

        function deshabilitarDrag(casilla) {

        }

        function habilitarDrag(casilla) {

        }


        function numCasillaFicha(ficha) {
            console.log(ficha.parentNode.parentNode)
            casillas = document.getElementsByClassName("casilla");
            for (i = 0; i < casillas.length; i++) {
                if (casillas[i] === ficha.parentNode.parentNode.parentNode) {
                    return Number(casillas[i].id);
                }
            }
            return -1;
        }
        function getCasillaEnPos(pos) {

            casillas = document.getElementsByClassName("casilla");
            for (i = 0; i < casillas.length; i++) {
                if (casillas[i].id == pos) {
                    return casillas[i];
                }
            }

            return null;

        }

        // function getNumFichasEnCasilla(numCasilla){
        //     casillas = document.getElementsByClassName("caja");

        //     return casillas[numCasilla].getElementsByClassName("ficha").length
        // }



        function girarDado(e) {
            if (victoria === false) {
                dado = e.currentTarget;

                numeroAleatorio = Math.floor(Math.random() * 6) + 1;

                const animation = dado.animate(
                    [
                        { transform: 'rotateX(0deg) rotateY(0deg) rotateZ(0deg)' },
                        { transform: 'rotateX(360deg) rotateY(360deg) rotateZ(360deg)' }
                    ],
                    {
                        duration: 1500,
                        easing: "ease"
                    }
                );

                animation.onfinish = () => {

                    dado.src = "dado" + numeroAleatorio + ".png"

                    fichaAMover = document.getElementById("ficha" + (turno % 2 + 1))

                    moverNCasillas(fichaAMover, numeroAleatorio)
                    turno++;
                    //textoTurno.textContent = "Turno de la ficha "+((turno%4+1))

                };
            }
        }

        sonidoFondo();
    </script>


</body>

</html>